syntax = "proto3";

package MeetChat;
// å¯¼å…¥ä¸€äº›å…¬å…±çš„ protobuf ç±»å‹
import "google/protobuf/any.proto";
import "google/protobuf/timestamp.proto";

// å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œè¡¨ç¤ºä¸åŒçš„æ¶ˆæ¯ç±»å‹
enum MessageType {
  TEXT = 0; // æ–‡æœ¬æ¶ˆæ¯
  EMOJI = 1; // è¡¨æƒ…æ¶ˆæ¯
  IMAGE = 2; // å›¾ç‰‡æ¶ˆæ¯
  FILE = 3; // æ–‡ä»¶æ¶ˆæ¯
  AV = 4; // éŸ³è§†é¢‘æ¶ˆæ¯
}

// å®šä¹‰ä¸€ä¸ªé€šç”¨çš„æ¶ˆæ¯ç±»å‹ï¼Œå¯ä»¥åŒ…å«ä¸åŒç±»å‹çš„æ•°æ®
message Message {
  // æ¶ˆæ¯çš„å‘é€è€…
  string sender_id = 1;
  // æ¶ˆæ¯çš„æ¥æ”¶è€…
  string receiver_id = 2; // -1 è¡¨ç¤ºæ‰€æœ‰äººæ¥å—
  // æ¶ˆæ¯çš„æ—¶é—´æˆ³
  google.protobuf.Timestamp timestamp = 3;
  // æ¶ˆæ¯çš„ç±»å‹ï¼Œä½¿ç”¨æšä¸¾ç±»å‹æ¥è¡¨ç¤º
  MessageType type = 4;
  // æ¶ˆæ¯çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œä½¿ç”¨ Any ç±»å‹æ¥å°è£…
  google.protobuf.Any data = 5;
}


// å®šä¹‰ä¸€ä¸ªAVPacketæ¶ˆæ¯ç±»å‹ï¼Œç”¨äºå­˜å‚¨éŸ³è§†é¢‘æ•°æ®
message AVPacket {
  int32 stream_index = 2; // éŸ³è§†é¢‘æ•°æ®çš„ç´¢å¼•
  int64 pts = 3; // æ˜¾ç¤ºæ—¶é—´æˆ³
  int64 dts = 4; // è§£ç æ—¶é—´æˆ³
  bytes data = 5; // å‹ç¼©æ•°æ®
  int32 size = 6; // å‹ç¼©æ•°æ®çš„é•¿åº¦
  int32 flags = 7; // æ ‡å¿—ä½
  int64 pos = 8; // åœ¨è¾“å…¥æ–‡ä»¶ä¸­çš„ä½ç½®
  int64 duration = 9; // æ—¶é•¿
}


// å®šä¹‰ä¸€ä¸ªæ–‡å­—æ¶ˆæ¯ç±»å‹ï¼ŒåŒ…å«æ–‡æœ¬å†…å®¹
message TextMessage {
  // æ–‡æœ¬å†…å®¹
  string text = 1;
}

// å®šä¹‰ä¸€ä¸ªè¡¨æƒ…ç±»å‹ï¼ŒåŒ…å«è¡¨æƒ…ç¬¦å·æˆ–å›¾ç‰‡
message Emoji {
  // è¡¨æƒ…ç¬¦å·ï¼Œä¾‹å¦‚ ğŸ˜Š æˆ– ğŸ˜‚
  string symbol = 1;
  // è¡¨æƒ…å›¾ç‰‡ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç¼–ç æ ¼å¼ï¼Œä¾‹å¦‚ PNG æˆ– GIF
  bytes image = 2;
}

// å®šä¹‰ä¸€ä¸ªå›¾ç‰‡ç±»å‹ï¼ŒåŒ…å«å›¾ç‰‡åç§°ã€å¤§å°å’Œæ•°æ®
message Image {
  // å›¾ç‰‡åç§°ï¼Œä¾‹å¦‚ "cat.jpg"
  string name = 1;
  // å›¾ç‰‡å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½
  int32 size = 2;
  // å›¾ç‰‡æ•°æ®ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç¼–ç æ ¼å¼ï¼Œä¾‹å¦‚ JPEG æˆ– PNG
  bytes data = 3;
}

// å®šä¹‰ä¸€ä¸ªæ–‡ä»¶ç±»å‹ï¼ŒåŒ…å«æ–‡ä»¶åç§°ã€å¤§å°å’Œæ•°æ®
message File {
  // æ–‡ä»¶åç§°ï¼Œä¾‹å¦‚ "report.pdf"
  string name = 1;
  // æ–‡ä»¶å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½
  int32 size = 2;
  // æ–‡ä»¶æ•°æ®ï¼Œå¯ä»¥æ˜¯ä»»ä½•æ ¼å¼
  bytes data = 3;
}